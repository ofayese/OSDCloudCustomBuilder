name: PowerShell Module CI

on: [push, pull_request]

jobs:
  build:
    runs-on: windows-latest
    steps:
    - uses: actions/checkout@v3
    - name: Install PowerShell Modules
      shell: pwsh
      run: |
        Install-Module -Name Pester -Force -Scope CurrentUser
        Install-Module -Name PSScriptAnalyzer -Force -Scope CurrentUser
    - name: Run Pester Tests
      shell: pwsh
      run: |
        Invoke-Pester -Path ./tests -CodeCoverage ./src/OSDCloudCustomBuilder -CI
